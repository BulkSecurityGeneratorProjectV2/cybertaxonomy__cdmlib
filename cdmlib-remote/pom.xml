<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <!-- 
		xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
		http://maven.apache.org/maven-v4_0_0.xsd"
   -->
	<parent>
		<groupId>eu.etaxonomy</groupId>
		<artifactId>cdmlib-parent</artifactId>
		<version>2.3</version>
	</parent>
	
  <modelVersion>4.0.0</modelVersion>
  <artifactId>cdmlib-remote</artifactId>
  <properties>
    <!--  
      custom property to hold the patch version number     
      should'nt this be set in the parent pom? 
     -->
    <project.patchversion>0</project.patchversion>
  </properties> 
  <name>CDM Community Server</name>
	<description>The EDIT CDM Community Server allows remote access to
		the common data model via webservices in the wider sense</description>
  <packaging>war</packaging>
  <scm>
		<connection>
			scm:svn:http://dev.e-taxonomy.eu/svn/trunk/cdmlib/cdmlib-remote/
		</connection>
		<developerConnection>
			scm:svn:https://dev.e-taxonomy.eu/svn/trunk/cdmlib/cdmlib-remote/
		</developerConnection>
		<url>
			http://dev.e-taxonomy.eu/trac/browser/trunk/cdmlib/cdmlib-remote/
		</url>
  </scm>

	<dependencies>
		<dependency>
			<groupId>eu.etaxonomy</groupId>
			<artifactId>cdmlib-ext</artifactId>
		</dependency>
		<dependency>
			<groupId>eu.etaxonomy</groupId>
			<artifactId>cdmlib-persistence</artifactId>
		</dependency>
		<dependency>
			<groupId>eu.etaxonomy</groupId>
			<artifactId>cdmlib-model</artifactId>
		</dependency>
		<dependency>
			<groupId>eu.etaxonomy</groupId>
			<artifactId>cdmlib-services</artifactId>
		</dependency>
		<dependency>
			<groupId>eu.etaxonomy</groupId>
			<artifactId>cdmlib-io</artifactId>
		</dependency>
		<!--<dependency>
			<groupId>org.mortbay.jetty</groupId>
			<artifactId>jetty</artifactId>
			<version>6.1.16</version>
		</dependency>
		--><dependency>
			<groupId>javax.servlet</groupId>
			<artifactId>servlet-api</artifactId>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>org.springframework.web</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>org.springframework.web.servlet</artifactId>
		</dependency>
		<dependency>
			<groupId>com.ibm.lsid</groupId>
			<artifactId>lsid-server</artifactId>
		</dependency>
		<dependency>
			<groupId>com.ibm.lsid</groupId>
			<artifactId>lsid-client</artifactId>
		</dependency>
		<dependency>
			<groupId>org.easymock</groupId>
			<artifactId>easymock</artifactId>
		</dependency>
		<dependency>
      <groupId>xmlunit</groupId>
      <artifactId>xmlunit</artifactId>
      </dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>org.springframework.test</artifactId>
		</dependency>
		<dependency>
			<groupId>net.sf.dozer</groupId>
			<artifactId>dozer</artifactId>
		</dependency>
		<dependency>
			<groupId>joda-time</groupId>
			<artifactId>joda-time</artifactId>    
		</dependency>
		<dependency>
      <groupId>org.hibernate</groupId>
      <artifactId>hibernate-cglib-repack</artifactId>
    </dependency>
    <dependency>
	  <groupId>org.hibernate</groupId>
	  <artifactId>hibernate-core</artifactId>
	</dependency>
	<dependency>
  	  <groupId>org.hibernate</groupId>
  	  <artifactId>hibernate-ehcache</artifactId>
  	</dependency>
    <dependency>
      <groupId>commons-io</groupId>
      <artifactId>commons-io</artifactId>
    </dependency>
		<!-- JsonView -->
    <dependency>
      <groupId>net.sf.json-lib</groupId>
      <artifactId>json-lib</artifactId>
      <version>2.2.3</version>
      <classifier>jdk15</classifier>   
    </dependency>
	<dependency>
	  <groupId>org.springframework</groupId>
	  <artifactId>org.springframework.oxm</artifactId>
	  <version>3.0.0.RC1</version>
	</dependency>

		<!-- XmlView -->
		<dependency>
			<groupId>com.thoughtworks.xstream</groupId>
			<artifactId>xstream</artifactId>
		</dependency>
		<dependency>
			<groupId>xpp3</groupId>
			<artifactId>xpp3</artifactId>
		</dependency>
		<dependency>
		  <groupId>stax</groupId>
		  <artifactId>stax</artifactId>
		</dependency>

		<!-- JSP TAG LIBS -->
		<dependency>
			<groupId>taglibs</groupId>
			<artifactId>standard</artifactId>
			<version>1.1.2</version>
		</dependency>
		<dependency>
			<groupId>taglibs</groupId>
			<artifactId>x</artifactId>
			<version>1.1.2</version>
			<type>tld</type>
		</dependency>

		<!--  SQL Profiling  -->
		<dependency>
		    <groupId>p6spy</groupId>
		    <artifactId>p6spy</artifactId>
		    <version>1.3</version>
		</dependency>

	</dependencies>
	<build>
	<!-- Configure the webapp -->
 	<finalName>cdmserver</finalName> 
		<plugins>
			<plugin>
			    <groupId>net.sf.alchim</groupId>
			    <artifactId>winstone-maven-plugin</artifactId>
			    <executions>
			        <execution>
			            <goals>
			                <goal>embed</goal>
			            </goals>
			            <phase>deploy</phase>
			        </execution>
			    </executions>
			</plugin>
			<plugin>
					<artifactId>maven-antrun-plugin</artifactId>
					<version>1.3</version>
						<executions>
							<execution>
								<phase>deploy</phase>
								<!--
									must run after winstone-maven-plugin
								-->
								<configuration>
									<tasks>
									  <!--
									   ${project.patchversion} is explicitely set in this pom
									    
									   ${buildNumber} is set by the buildnumber-maven-plugin  
                     Cannot create the build number if you have local modifications, 
                     to allow creating a buildnumber anyway you can ommit 									  
									  -->
									  <property name="project.fullversionstring" value="${project.version}.${project.patchversion}.r${buildNumber}"/>
										<ant antfile="${project.basedir}/src/main/installer/linux/build-deb.xml" dir="${project.basedir}" />
									</tasks>
								</configuration>
								<goals>
									<goal>run</goal>
								</goals>
							</execution>
						</executions>
        </plugin>
				
			<!--<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-war-plugin</artifactId>
				<version>2.0</version>
				<configuration>
					<archive>
						<manifest>
							<addClasspath>true</addClasspath>
							<mainClass>eu.etaxonomy.cdm.server.CdmServer
							</mainClass>
						</manifest>
					</archive>
				</configuration>
				<executions>
					<execution>
						<id>move-main-class</id>
						<phase>compile</phase>
						<configuration>
							<tasks>
								  Ant tasks 
								<echo>Moving CdmServer.class to ${project.build.directory}/${project.artifactId}</echo>
								<move todir="${project.build.directory}/${project.artifactId}">
									<fileset dir="${project.build.directory}/classes/">
										<include name="**/CdmServer.class" />
									</fileset>
								</move>
							</tasks>
						</configuration>
						<goals>
							<goal>war</goal>
						</goals>
					</execution>
				</executions>
			</plugin>
			-->
			<plugin>
				<!--
					to run use: mvn jetty:run for debugging: export MAVEN_OPTS="-Xdebug
					-Xnoagent -Djava.compiler=NONE
					-Xrunjdwp:transport=dt_socket,address=4000,server=y,suspend=n" mvn
					jetty:run for faster startup offline mode & skip tests: mvn -o
					-Dmaven.test.skip=true jetty:run-war an eclipse plugin to
					start/restart/stop jetty6
					http://dbpowder.sourceforge.net/etc/jettylauncher6/updates/ see also:
					http://docs.codehaus.org/display/JETTY/Debugging+with+the+Maven+Jetty+Plugin+inside+Eclipse
					http://mahertb.blogspot.com/2006/08/debugging-maven-web-application-with.html
				-->
				<groupId>org.mortbay.jetty</groupId>
				<artifactId>maven-jetty-plugin</artifactId>
				<configuration>
					<!-- Configure the webapp -->
					<contextPath>/</contextPath>
					<!-- configure the container -->
					<scanIntervalSeconds>0</scanIntervalSeconds>
					<connectors>
						<connector implementation="org.mortbay.jetty.nio.SelectChannelConnector">
							<port>8080</port>
							<maxIdleTime>60000</maxIdleTime>
						</connector>
					</connectors>
					<requestLog implementation="org.mortbay.jetty.NCSARequestLog">
						<filename>target/request.log</filename>
						<retainDays>30</retainDays>
						<append>true</append>
						<extended>false</extended>
						<logTimeZone>GMT</logTimeZone>
					</requestLog>
				</configuration>
			</plugin>
		</plugins>
	</build>
</project>

