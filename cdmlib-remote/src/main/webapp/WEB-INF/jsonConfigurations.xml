<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans   http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
    http://www.springframework.org/schema/context   http://www.springframework.org/schema/context/spring-context-2.5.xsd
    http://www.springframework.org/schema/tx   http://www.springframework.org/schema/tx/spring-tx-2.5.xsd
    ">

	<!-- 
         =================================================
            default configuration for RESTful read(/write) service         
         =================================================
    -->
	<bean name="jsonConfig" class="eu.etaxonomy.cdm.remote.json.JsonConfigFactoryBean"
		init-method="init">
		<property name="jsonBeanProcessorMatcher">
			<bean
				class="eu.etaxonomy.cdm.remote.json.processor.matcher.CdmProxyBeanProcessorMatcher" />
		</property>
		<property name="jsonBeanProcessors">
			<map>
				<entry key="org.hibernate.proxy.HibernateProxy">
					<bean class="eu.etaxonomy.cdm.remote.json.processor.bean.HibernateProxyBeanProcessor" />
				</entry>
				<entry key="eu.etaxonomy.cdm.model.common.TermBase">
					<bean class="eu.etaxonomy.cdm.remote.json.processor.bean.TermBaseBeanProcessor" />
				</entry>
				<entry key="eu.etaxonomy.cdm.model.description.TextData">
					<bean class="eu.etaxonomy.cdm.remote.json.processor.bean.TextDataBeanProcessor" />
				</entry>
				<entry key="eu.etaxonomy.cdm.model.taxon.TaxonNode">
					<bean class="eu.etaxonomy.cdm.remote.json.processor.bean.TaxonNodeBeanProcessor" />
				</entry>
			  <entry key="eu.etaxonomy.cdm.model.reference.ReferenceBase">
          <bean class="eu.etaxonomy.cdm.remote.json.processor.bean.ReferenceBaseBeanProcessor"/>
        </entry>
			</map>
		</property>
		<property name="jsonPropertyFilter">
            <bean class="net.sf.json.filters.OrPropertyFilter">
              <constructor-arg>
                  <bean class="eu.etaxonomy.cdm.remote.json.util.InitializedHibernatePropertyFilter" />
              </constructor-arg>
              <constructor-arg>
                  <bean class="eu.etaxonomy.cdm.remote.json.util.CardinalityPropertyFilter">
                      <property name="includeToOneRelations" value="false" />
                      <property name="includeToManyRelations" value="false" />
                      <property name="exceptions">
                        <set>
                            <value>FeatureTree.root</value>
                            <value>FeatureNode.children</value>
                            <value>FeatureNode.feature</value>
                            <value>TreeNode.data</value>
                        </set>
                      </property>
                    </bean>
              </constructor-arg>
            </bean>
        </property>
		<property name="jsonValueProcessors">
			<map>
				<entry key="org.hibernate.proxy.HibernateProxy">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.HibernateJSONValueProcessor" />
				</entry>
				<entry key="java.util.UUID">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.UUIDJSONValueProcessor" />
				</entry>
				<entry key="org.joda.time.DateTime">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.DateTimeJSONValueProcessor" />
				</entry>
				<entry key="java.util.Calendar">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.CalendarJSONValueProcessor" />
				</entry>
				<entry key="org.joda.time.Partial">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.PartialJSONValueProcessor" />
				</entry>
				<entry key="java.lang.Class">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.ClassJSONValueProcessor" />
				</entry>
				<entry key="java.util.Map">
				    <bean class="eu.etaxonomy.cdm.remote.json.processor.value.MapJSONValueProcessor" />
				</entry>
			</map>
		</property>
		<property name="ignoreDefaultExcludes" value="true" />
		<property name="excludes">
			<list value-type="java.lang.String">
				<value>declaringClass</value><!-- DefaultExclude -->
				<value>metaClass</value><!-- DefaultExclude -->
				<value>id</value>
				<value>cacheStrategy</value>
			</list>
		</property>
	</bean>

	<!-- 
         =================================================
            configuration for RESTful taxonomy service 
         =================================================
    -->
	<bean name="jsonConfigTaxonomy" class="eu.etaxonomy.cdm.remote.json.JsonConfigFactoryBean"
		init-method="init">
		<property name="jsonBeanProcessorMatcher">
			<bean
				class="eu.etaxonomy.cdm.remote.json.processor.matcher.HibernateProxyBeanProcessorMatcher" />
		</property>
		<property name="jsonBeanProcessors">
			<map>
				<entry key="org.hibernate.proxy.HibernateProxy">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.bean.HibernateProxyBeanProcessor" />
				</entry>
				<entry key="eu.etaxonomy.cdm.model.taxon.TaxonNode">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.bean.TaxonNodeDaoBeanProcessor" />
				</entry>
			</map>
		</property>
		<property name="jsonPropertyFilter">
            <bean class="eu.etaxonomy.cdm.remote.json.util.InitializedHibernatePropertyFilter" />
        </property>
		<property name="jsonValueProcessors">
			<map>
				<entry key="org.hibernate.proxy.HibernateProxy">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.HibernateJSONValueProcessor" />
				</entry>
				<entry key="java.util.UUID">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.UUIDJSONValueProcessor" />
				</entry>
				<entry key="org.joda.time.DateTime">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.DateTimeJSONValueProcessor" />
				</entry>
				<entry key="java.util.Calendar">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.CalendarJSONValueProcessor" />
				</entry>
				<entry key="org.joda.time.Partial">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.PartialJSONValueProcessor" />
				</entry>
				<entry key="java.lang.Class">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.ClassJSONValueProcessor" />
				</entry>
                <entry key="java.util.Map">
                    <bean class="eu.etaxonomy.cdm.remote.json.processor.value.MapJSONValueProcessor" />
                </entry>
			</map>
		</property>
		<property name="ignoreDefaultExcludes" value="true" />
		<property name="excludes">
			<list value-type="java.lang.String">
				<value>declaringClass</value><!-- DefaultExclude -->
				<value>metaClass</value><!-- DefaultExclude -->
				<value>id</value>
				<value>cacheStrategy</value>
			</list>
		</property>
	</bean>

	<!-- 
	     =================================================
	       configuration for RESTful portal service 
	     =================================================
	-->

	<bean name="jsonConfigPortal" class="eu.etaxonomy.cdm.remote.json.JsonConfigFactoryBean"
		init-method="init">
		<property name="jsonBeanProcessorMatcher">
			<bean
				class="eu.etaxonomy.cdm.remote.json.processor.matcher.CdmProxyBeanProcessorMatcher" />
		</property>
		<property name="jsonBeanProcessors">
			<map>
				<entry key="org.hibernate.proxy.HibernateProxy">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.bean.HibernateProxyBeanProcessor" />
				</entry>
				<entry key="eu.etaxonomy.cdm.model.taxon.Taxon">
					<bean class="eu.etaxonomy.cdm.remote.json.processor.bean.TaxonBeanProcessor" />
				</entry>
				<entry key="eu.etaxonomy.cdm.model.name.TaxonNameBase">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.bean.TaxonNameBaseBeanProcessor" />
				</entry>
				<entry key="eu.etaxonomy.cdm.model.name.NameRelationship">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.bean.NameRelationshipBeanProcessor" />
				</entry>
				<entry key="eu.etaxonomy.cdm.model.taxon.TaxonRelationship">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.bean.TaxonRelationshipBeanProcessor" />
				</entry>
				<entry key="eu.etaxonomy.cdm.model.common.TermBase">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.bean.TermBaseBeanProcessor">
						<property name="replaceRepresentations" value="true" />
					</bean>
				</entry>
				<entry key="eu.etaxonomy.cdm.model.description.TextData">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.bean.TextDataBeanProcessor">
						<property name="replaceMultilanguageText" value="true" />
					</bean>
				</entry>
				<entry key="eu.etaxonomy.cdm.model.media.Media">
					<bean class="eu.etaxonomy.cdm.remote.json.processor.bean.MediaBeanProcessor">
						<property name="replaceTitle" value="true" />
						<property name="replaceDescription" value="true" />
					</bean>
				</entry>
			  <entry key="eu.etaxonomy.cdm.model.reference.ReferenceBase">
                <bean class="eu.etaxonomy.cdm.remote.json.processor.bean.ReferenceBaseBeanProcessor"/>
              </entry>
			</map>
		</property>
        <property name="jsonPropertyFilter">
            <bean class="eu.etaxonomy.cdm.remote.json.util.InitializedHibernatePropertyFilter" />
        </property>
		<property name="jsonValueProcessors">
			<map>
				<entry key="org.hibernate.proxy.HibernateProxy">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.HibernateJSONValueProcessor" />
				</entry>
				<entry key="java.util.UUID">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.UUIDJSONValueProcessor" />
				</entry>
				<entry key="org.joda.time.DateTime">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.DateTimeJSONValueProcessor" />
				</entry>
				<entry key="java.util.Calendar">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.CalendarJSONValueProcessor" />
				</entry>
				<entry key="org.joda.time.Partial">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.PartialJSONValueProcessor" />
				</entry>
				<entry key="java.lang.Class">
					<bean
						class="eu.etaxonomy.cdm.remote.json.processor.value.ClassJSONValueProcessor" />
				</entry>
                <entry key="java.util.Map">
                    <bean class="eu.etaxonomy.cdm.remote.json.processor.value.MapJSONValueProcessor" />
                </entry>
			</map>
		</property>
		<property name="ignoreDefaultExcludes" value="true" />
		<property name="excludes">
			<list value-type="java.lang.String">
				<value>declaringClass</value><!-- DefaultExclude -->
				<value>metaClass</value><!-- DefaultExclude -->
				<value>id</value>
				<value>annotations</value>
				<value>cacheStrategy</value>
				<value>markers</value>
				<!--
					FIXME must exclude partOf, kindOf, includes, generalizationOf .. to
					avoid class cast or lazy loading exceptions in TDWG Areas
				-->
				<value>partOf</value>
				<value>kindOf</value>
				<value>includes</value>
				<value>generalizationOf</value>
			</list>
		</property>
	</bean> 
</beans>